<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¯ÙØªØ± ÙŠÙˆÙ…ÙŠØ§ØªÙŠ</title>
<style>
  body { font-family: sans-serif; margin:0; padding:0; background:#f0f0f0; }
  #lockScreen, #app { display:none; height:100vh; align-items:center; justify-content:center; }
  #lockScreen { background:#222; color:#fff; flex-direction:column; }
  #lockScreen input { padding:10px; font-size:18px; margin:10px; }
  #app { flex-direction:column; }
  header { background:#333; color:#fff; padding:10px; display:flex; justify-content:space-between; align-items:center; }
  header button { margin-left:5px; }
  #editor { flex:1; padding:10px; background:#fff; margin:10px; border-radius:8px; overflow:auto; min-height:200px; }
  #editor[contenteditable="true"] { outline:none; }
  footer { padding:10px; display:flex; gap:5px; flex-wrap:wrap; }
  button { padding:5px 10px; border:none; border-radius:5px; cursor:pointer; }
  .dark { background:#111; color:#ddd; }
  .dark header { background:#000; }
  .dark #editor { background:#222; color:#eee; }
</style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ÙÙ„ -->
<div id="lockScreen">
  <h2>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ù„Ù„Ø¯Ø®ÙˆÙ„</h2>
  <input type="password" id="pinInput" placeholder="Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„">
  <button onclick="unlock()">Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
<div id="app">
  <header>
    <span>ğŸ““ Ø¯ÙØªØ± ÙŠÙˆÙ…ÙŠØ§ØªÙŠ</span>
    <div>
      <button onclick="toggleTheme()">ğŸŒ™/â˜€ï¸</button>
      <button onclick="exportData()">ğŸ’¾ ØªØµØ¯ÙŠØ±</button>
      <input type="file" id="importFile" onchange="importData(event)" style="display:none">
      <button onclick="document.getElementById('importFile').click()">ğŸ“‚ Ø§Ø³ØªØ¹Ø§Ø¯Ø©</button>
      <button onclick="lock()">ğŸ”’ Ù‚ÙÙ„</button>
    </div>
  </header>
  
  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ -->
  <footer>
    <button onclick="format('bold')">B</button>
    <button onclick="format('italic')">I</button>
    <button onclick="format('underline')">U</button>
    <button onclick="format('insertUnorderedList')">â€¢ Ù‚Ø§Ø¦Ù…Ø©</button>
    <button onclick="format('justifyCenter')">ÙˆØ³Ø·</button>
    <button onclick="format('insertImage', prompt('Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©:'))">ğŸ–¼</button>
    <button onclick="insertDate()">ğŸ“… ØªØ§Ø±ÙŠØ®</button>
    <input type="text" id="tagInput" placeholder="Ø£Ø¶Ù ÙˆØ³Ù… #">
    <button onclick="saveEntry()">Ø­ÙØ¸</button>
  </footer>
  
  <!-- Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© -->
  <div id="editor" contenteditable="true"></div>
  
  <!-- Ø§Ù„Ø¨Ø­Ø« -->
  <div style="padding:10px;">
    <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø«...">
    <button onclick="searchEntries()">ğŸ” Ø¨Ø­Ø«</button>
    <div id="results"></div>
  </div>
</div>

<script>
const STORAGE_KEY = "myJournal";
let isDark = false;

// Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ÙÙ„
document.getElementById("lockScreen").style.display = "flex";
function unlock(){
  const pin = document.getElementById("pinInput").value;
  if(pin === "1234"){ // ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡
    document.getElementById("lockScreen").style.display="none";
    document.getElementById("app").style.display="flex";
    loadLastEntry();
  } else { alert("Ø±Ù…Ø² Ø®Ø§Ø·Ø¦!"); }
}
function lock(){
  saveEntry();
  document.getElementById("app").style.display="none";
  document.getElementById("lockScreen").style.display="flex";
}

// ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Øµ
function format(cmd, val=null){ document.execCommand(cmd,false,val); }
function insertDate(){ format("insertText", new Date().toLocaleString()); }

// Ø§Ù„Ø­ÙØ¸
function saveEntry(){
  const content = document.getElementById("editor").innerHTML;
  const tag = document.getElementById("tagInput").value;
  let data = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  data.push({content, tag, date:new Date().toLocaleString()});
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…");
}
function loadLastEntry(){
  let data = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  if(data.length>0){ document.getElementById("editor").innerHTML = data[data.length-1].content; }
}

// Ø§Ù„Ø¨Ø­Ø«
function searchEntries(){
  const q = document.getElementById("searchInput").value.toLowerCase();
  let data = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  let res = data.filter(e => e.content.toLowerCase().includes(q) || (e.tag && e.tag.includes(q)));
  document.getElementById("results").innerHTML = res.map(r=>"<div><b>"+r.date+"</b>: "+(r.tag||"")+"</div>").join("");
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
function toggleTheme(){
  isDark = !isDark;
  document.body.classList.toggle("dark", isDark);
}

// ØªØµØ¯ÙŠØ±/Ø§Ø³ØªØ¹Ø§Ø¯Ø©
function exportData(){
  const data = localStorage.getItem(STORAGE_KEY) || "[]";
  const blob = new Blob([data], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "journal.json";
  a.click();
}
function importData(e){
  const file = e.target.files[0];
  const reader = new FileReader();
  reader.onload = () => { localStorage.setItem(STORAGE_KEY, reader.result); alert("ØªÙ… Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© âœ…"); };
  reader.readAsText(file);
}
</script>

</body>
</html>